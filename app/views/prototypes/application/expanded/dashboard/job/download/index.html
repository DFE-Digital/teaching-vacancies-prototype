{% extends "templates/form-template.html" %}

{% set jobName = data.jobs[jobId].name %}
{% set formAction = "./download/check-answers" %}

{% block formContent %}

  <h1 class="govuk-heading-m govuk-!-margin-bottom-0">
    <span class="govuk-caption-l">{{ jobName }}</span>
  </h1>

  {# TODO - get this working! #}
  {# {% set applicationsNamesItems = []  %}

  {% set applicationsNamesItems = applicationsNamesItems | push ({ 
    text: "Select all"
  }) %}

  {% set applicationsNamesItems = applicationsNamesItems | push ({ 
    divider: "or"
  }) %}

  {% for name, application in data.applications  %}
    {% if application.status != "Withdrawn" %}

      {% set checkboxHtml %}
        {{ application.firstname + " " +  application.lastname }}<br>
        <div class="govuk-!-margin-top-1">{% include "includes/applications/application-status-tags.html" %}</div>
      {% endset %}

      {% set applicationsNamesItems = applicationsNamesItems | push ({ 
        html: checkboxHtml | safe
      }) %}
    {% endif %}
  {% endfor %}

  {{ govukCheckboxes({
    fieldset: {
      legend: {
        text: "Which applications do you want to download?",
        isPageHeading: true,
        classes: "govuk-fieldset__legend--l"
      }
    },
    items: applicationsNamesItems
  } | decorateAttributes(data, "data.job.applicationsToDownload")) }} #}

  {# Setting dummy statuses for now  #} 
  {% set checkbox1 %}
    Liliya Yeva
    <div class="govuk-!-margin-top-1">
      {{govukTag({
        text: "Received",
        classes: "govuk-tag--blue"
      })}}
    </div>
  {% endset %}

  {% set checkbox2 %}
    Mildred Finn
    <div class="govuk-!-margin-top-1">
      {{govukTag({
        text: "Received",
        classes: "govuk-tag--blue"
      })}}
    </div>
  {% endset %}

  {% set checkbox3 %}
    Ronald Kenyon
    <div class="govuk-!-margin-top-1">
      {{govukTag({
        text: "Received",
        classes: "govuk-tag--blue"
      })}}
    </div>
  {% endset %}

  {% set checkbox4 %}
    Sadie Roberts
    <div class="govuk-!-margin-top-1">
      {{govukTag({
        text: "Received",
        classes: "govuk-tag--blue"
      })}}
    </div>
  {% endset %}

  {{ govukCheckboxes({
    fieldset: {
      legend: {
        text: "Which applications do you want to download?",
        classes: "govuk-fieldset__legend--l",
        isPageHeading: true
      }
    },
    items: [
      {
        text: "Select all"  
      },
      {
        divider: "or"
      },
      {
        html: checkbox1,
        value: "Liliya Yeva"
      },
      {
        html: checkbox2,
        value: "Mildred Finn"
      },
      {
        html: checkbox3,
        value: "Ronald Kenyon"
      },
      {
        html: checkbox4,
        value: "Sadie Roberts"
      }
    ]
  } | decorateAttributes(data, "data.job.applicationsToDownload")) }}

  <div class="govuk-button-group">
    {{ govukButton({
      text: "Continue"
    }) }}
    <a class="govuk-link" href="./applications">Cancel</a>
  </div>

{% endblock %}